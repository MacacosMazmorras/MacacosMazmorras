@model MacacosMazmorrasMVC.ViewModels.SessionViewModel
<head>
    <link rel="stylesheet" href="~/css/SessionView.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/CombatCards.css" asp-append-version="true" />
</head>

<body class="bg-campaign">
    <h1 class="titulo">@Model.Session.SesionName</h1>
    <h6 class="text-center text-white">@(Model.Session.SesionDate.HasValue ? Model.Session.SesionDate.Value.ToString("dd/MM/yyyy") : " There is still no set date")</h6>
    <div class="floating-button-return">
        <a asp-controller="Campaign" asp-action="CampaignSesions" type="button">
            <a asp-controller="Campaign" asp-action="CampaignSesions" type="button" class="text-decoration-none"><button class="whiteButton-normal"><b>Return</b></button></a>
        </a>
    </div>
    <main class="container mt-5" style="display: flex">
        <section style="flex: 2">
            <article>
                @{
                    int i = 0;
                    <div>
                        @foreach (SheetCustom sheetCustom in Model.SheetCustoms)
                        {
                            {
                                <div class="hover-scale bounce">
                                    <div class="next-turn-list-unit">
                                        <div class="row">
                                            <img class="next-turn-list-image" src="@Model.SheetCustoms[i].ImgUrl" />

                                            <div class="col">
                                                <div class="progress-bar-bg border-1 border-dark">
                                                    <div class="progress-bar bg-danger progress-bar-striped" role="progressbar" style="max-width: 100%; height: 25px; width: @(Model.SheetCustoms[i].SesionHp * 100 / @Model.SheetCustoms[i].Hp)%;" aria-valuenow="@Model.SheetCustoms[i].SesionHp" aria-valuemin="0" aria-valuemax="@Model.SheetCustoms[i].Hp">
                                                        <span class="text-black fw-bold" id="sesionHp">@Model.SheetCustoms[i].SesionHp / @Model.SheetCustoms[i].Hp</span>
                                                    </div>
                                                </div>
                                                <div class="d-flex justify-content-center align-items-center bg-dark">
                                                    <p class="text-white text-center fw-bold mb-0">
                                                        @Model.SheetCustoms[i].Name
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            i++;
                        }
                    </div>
                }
            </article>
        </section>
        <section class="text-area">
            <article class="text-white">
                <pre class="textOverflow">@Model.Session.SesionDesc</pre>
            </article>
        </section>
        <section class="right-area">
            <div style="width: 100%; height: 150px;" class="spoty-img mb-5">
                <p>SPOTIFY PLACEHOLDER</p>
            </div>
            <div>
                <button id="chooseEnemiesBtn" class="blueButton-session"><b>Choose Enemies</b></button>
            </div>
            <div class="floating-button">
                <a asp-controller="Session" asp-action="StartCombat" type="button" method="get">
                    <button class="floating-button-plus d-xl-none fs-3 fw-bolder">
                        Go
                    </button>
                    <a asp-controller="Session" asp-action="StartCombat" method="get" type="button" class="text-decoration-none">
                        <button id="startCombatButton" class="whiteButton-normal d-none d-xl-block"><b>Start Combat</b></button>
                    </a>
                </a>
            </div>
        </section>
    </main>
</body>


<div class="modal fade mt-5" id="chooseEnemiesModal" tabindex="-1" role="dialog" aria-labelledby="chooseEnemiesModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content  modal-style text-white">
            <div class="modal-header">
                <h5 class="modal-title" id="chooseEnemiesModalLabel">Select Monsters</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Contenido del modal -->
                @using (Html.BeginForm("SelectedMonsters", "Session", FormMethod.Post))
                {
                    <ul>
                        @foreach (var monster in Model.Monsters)
                        {
                            <li>
                                <label>
                                    @Html.CheckBox("selectedMonsters", false, new { value = monster.Name, @class = "monsterCheckbox" })
                                    @monster.Name
                                </label>
                            </li>
                        }
                    </ul>

                    <input type="submit" value="Add" />
                }
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var chooseEnemiesBtn = document.getElementById('chooseEnemiesBtn');
        var chooseEnemiesModal = new bootstrap.Modal(document.getElementById('chooseEnemiesModal'));
        var startCombatButton = document.getElementById('startCombatButton');

        chooseEnemiesBtn.addEventListener('click', function () {
            chooseEnemiesModal.show();
        });

        // Add an event listener for when the modal is closed
        chooseEnemiesModal._element.addEventListener('hidden.bs.modal', function () {
            // Check if any monsters are selected in the modal
            var selectedMonsters = document.querySelectorAll('.monsterCheckbox:checked');

            // Toggle the Bootstrap class 'd-none' based on the selection
            if (selectedMonsters.length > 0) {
                // Show the button
                startCombatButton.classList.remove('d-none');
            } else {
                // Hide the button
                startCombatButton.classList.add('d-none');
            }
        });
    });
</script>


